<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="TimeBankCU.Views.MePage"
             Title="Me"
             xmlns:viewmodels="clr-namespace:TimeBankCU.ViewModels"
             xmlns:models="clr-namespace:TimeBankCU.ViewModels"
             x:DataType="viewmodels:MeViewModel"
             BackgroundColor="#F5F5F5">

    <ContentPage.BindingContext>
        <viewmodels:MeViewModel />
    </ContentPage.BindingContext>

    <ScrollView>
        <StackLayout Padding="20" Spacing="20">

            <!-- Top Section: User Info -->
            <Frame HasShadow="True" CornerRadius="10" Padding="15" BackgroundColor="White">
                <StackLayout Orientation="Horizontal" Spacing="15">
                    <Frame WidthRequest="100" HeightRequest="100" CornerRadius="50" IsClippedToBounds="True" HasShadow="False" Padding="0">
                        <Image Source="{Binding UserAvatar}" Aspect="AspectFill"/>
                    </Frame>

                    <StackLayout VerticalOptions="Center">
                        <Label Text="{Binding UserName}" FontSize="24" FontAttributes="Bold" TextColor="#333" />
                        <Label Text="{Binding UserSkills}" FontSize="14" TextColor="#666" />
                        <Button Text="➕ Add Skill"
                                Command="{Binding AddSkillCommand}"
                                BackgroundColor="#0077CC"
                                TextColor="White"
                                FontAttributes="Bold"
                                CornerRadius="6"
                                Margin="0,10,0,0"/>
                    </StackLayout>
                </StackLayout>
            </Frame>

            <!-- Core Data Section -->
            <Frame HasShadow="True" CornerRadius="10" Padding="15" BackgroundColor="White">
                <StackLayout Spacing="15">
                    <Label Text="My Tasks" FontSize="20" FontAttributes="Bold" TextColor="#333" />
                    <CollectionView ItemsSource="{Binding MyTasks}" HeightRequest="120">
                        <CollectionView.ItemsLayout>
                            <LinearItemsLayout Orientation="Vertical"/>
                        </CollectionView.ItemsLayout>
                        <CollectionView.ItemTemplate>
                            <DataTemplate x:DataType="models:Task">
                                <Frame BackgroundColor="#FAFAFA" CornerRadius="8" Padding="10" Margin="5" HasShadow="True">
                                    <Label Text="{Binding TaskName}" TextColor="#222" />
                                </Frame>
                            </DataTemplate>
                        </CollectionView.ItemTemplate>
                    </CollectionView>

                    <Label Text="Search History" FontSize="20" FontAttributes="Bold" TextColor="#333" />
                    <CollectionView ItemsSource="{Binding SearchingHistory}" HeightRequest="120">
                        <CollectionView.ItemTemplate>
                            <DataTemplate x:DataType="models:SearchHistory">
                                <Frame BackgroundColor="#FAFAFA" CornerRadius="8" Padding="10" Margin="5" HasShadow="True">
                                    <Label Text="{Binding SearchTerm}" TextColor="#222" />
                                </Frame>
                            </DataTemplate>
                        </CollectionView.ItemTemplate>
                    </CollectionView>

                    <Label Text="Time Credits" FontSize="20" FontAttributes="Bold" TextColor="#333" />
                    <Label Text="{Binding TimeCredits}" FontSize="18" TextColor="#0077CC" FontAttributes="Bold"/>
                </StackLayout>
            </Frame>

            <!-- Function Options Section -->
            <Frame HasShadow="True" CornerRadius="10" Padding="15" BackgroundColor="White">
                <StackLayout Spacing="10">
                    <Button Text="⭐ Favorites" Command="{Binding NavigateCommand}" CommandParameter="Favorites" />
                    <Button Text="🔐 Security" Command="{Binding NavigateCommand}" CommandParameter="Security" />
                    <Button Text="❓ Help - Feedback" Command="{Binding NavigateCommand}" CommandParameter="Help-Feedback" />
                    <Button Text="👍 Leave a Review" Command="{Binding NavigateCommand}" CommandParameter="Review" />
                    <Button Text="🚪 Log Out" Command="{Binding LogoutCommand}" 
                            BackgroundColor="#E53935"
                            TextColor="White"
                            FontAttributes="Bold"
                            CornerRadius="6"/>
                </StackLayout>
            </Frame>

        </StackLayout>
    </ScrollView>
</ContentPage>
